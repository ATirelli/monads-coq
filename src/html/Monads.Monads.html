<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">Monads.Monads</h1>

<div class="code">
</div>

<div class="doc">
<a id="lab4"></a><h1 class="section">Monads in FP through examples</h1>


<div class="paragraph"> </div>

The aim of this notebook is to present the use of monads in functional programming. This will be done 
mainly through examples, using three relevant use cases, in which the use of monads offers an elegant 
and unifying perspective on seemingly different problems. To highlight the relevance of the monads approach, 
for each of the use cases presented, we shall compare such an approach to the sandard <i>ad hoc</i> solution for
the problem at hand.  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#"><span class="id" title="library">NPeano</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.Arith.html#"><span class="id" title="library">Arith</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Bool.Bool.html#"><span class="id" title="library">Bool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#"><span class="id" title="library">String</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Logic.FunctionalExtensionality.html#"><span class="id" title="library">Coq.Logic.FunctionalExtensionality</span></a>.<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <a id="functional_extensionality" class="idref" href="#functional_extensionality"><span class="id" title="axiom">functional_extensionality</span></a> : <span class="id" title="keyword">forall</span> {<a id="X:1" class="idref" href="#X:1"><span class="id" title="binder">X</span></a> <a id="Y:2" class="idref" href="#Y:2"><span class="id" title="binder">Y</span></a>: <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="f:3" class="idref" href="#f:3"><span class="id" title="binder">f</span></a> <a id="g:4" class="idref" href="#g:4"><span class="id" title="binder">g</span></a> : <a class="idref" href="Monads.Monads.html#X:1"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#Y:2"><span class="id" title="variable">Y</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> (<a id="x:5" class="idref" href="#x:5"><span class="id" title="binder">x</span></a>:<a class="idref" href="Monads.Monads.html#X:1"><span class="id" title="variable">X</span></a>), <a class="idref" href="Monads.Monads.html#f:3"><span class="id" title="variable">f</span></a> <a class="idref" href="Monads.Monads.html#x:5"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#g:4"><span class="id" title="variable">g</span></a> <a class="idref" href="Monads.Monads.html#x:5"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#f:3"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#g:4"><span class="id" title="variable">g</span></a>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="Show" class="idref" href="#Show"><span class="id" title="record">Show</span></a>(<a id="A:7" class="idref" href="#A:7"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) := {<br/>
&nbsp;&nbsp;<a id="show" class="idref" href="#show"><span class="id" title="projection">show</span></a> : <a class="idref" href="Monads.Monads.html#A:7"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="digit2string" class="idref" href="#digit2string"><span class="id" title="definition">digit2string</span></a>(<a id="d:10" class="idref" href="#d:10"><span class="id" title="binder">d</span></a>:<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#d:10"><span class="id" title="variable">d</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; "0" | 1 =&gt; "1" | 2 =&gt; "2" | 3 =&gt; "3"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 4 =&gt; "4" | 5 =&gt; "5" | 6 =&gt; "6" | 7 =&gt; "7"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 8 =&gt; "8" | <span class="id" title="var">_</span> =&gt; "9"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span> %<span class="id" title="var">string</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="digits'" class="idref" href="#digits'"><span class="id" title="definition">digits'</span></a>(<a id="fuel:12" class="idref" href="#fuel:12"><span class="id" title="binder">fuel</span></a> <a id="n:13" class="idref" href="#n:13"><span class="id" title="binder">n</span></a>:<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="accum:14" class="idref" href="#accum:14"><span class="id" title="binder">accum</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#fuel:12"><span class="id" title="variable">fuel</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <a class="idref" href="Monads.Monads.html#accum:14"><span class="id" title="variable">accum</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">fuel'</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#n:13"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <a class="idref" href="Monads.Monads.html#accum:14"><span class="id" title="variable">accum</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">let</span> <a id="d:18" class="idref" href="#d:18"><span class="id" title="binder">d</span></a> := <a class="idref" href="Monads.Monads.html#digit2string"><span class="id" title="definition">digit2string</span></a>(<a class="idref" href="Monads.Monads.html#n:13"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.PeanoNat.html#::nat_scope:x_'mod'_x"><span class="id" title="notation">mod</span></a> 10) <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#digits':15"><span class="id" title="definition">digits'</span></a> <span class="id" title="var">fuel'</span> (<a class="idref" href="Monads.Monads.html#n:13"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.PeanoNat.html#2e0d8202c5a48097752d760d3a1db6a7"><span class="id" title="notation">/</span></a> 10) (<a class="idref" href="Monads.Monads.html#d:18"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#169ad156fbc6036a53a0338819a2b301"><span class="id" title="notation">++</span></a> <a class="idref" href="Monads.Monads.html#accum:14"><span class="id" title="variable">accum</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="digits" class="idref" href="#digits"><span class="id" title="definition">digits</span></a> (<a id="n:19" class="idref" href="#n:19"><span class="id" title="binder">n</span></a>:<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#digits'"><span class="id" title="definition">digits'</span></a> <a class="idref" href="Monads.Monads.html#n:19"><span class="id" title="variable">n</span></a> <a class="idref" href="Monads.Monads.html#n:19"><span class="id" title="variable">n</span></a> "" <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| "" =&gt; "0"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ds</span> =&gt; <span class="id" title="var">ds</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span> %<span class="id" title="var">string</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <a id="natShow" class="idref" href="#natShow"><span class="id" title="instance">natShow</span></a> : <a class="idref" href="Monads.Monads.html#Show"><span class="id" title="class">Show</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> := { <br/>
&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#show"><span class="id" title="method">show</span></a> := <a class="idref" href="Monads.Monads.html#digits"><span class="id" title="definition">digits</span></a><br/>
}.<br/>

<br/>
</div>

<div class="doc">
We start by defining an ultra simple language of terms, 
where we have constants and divisions. This will be our toy model 
on which we will defined three monads: 
<ul class="doclist">
<li> the exception monad

</li>
<li> the simplified state monad

</li>
<li> the output monad 

</li>
</ul>
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a id="tm" class="idref" href="#tm"><span class="id" title="inductive">tm</span></a> := <br/>
| <a id="Con" class="idref" href="#Con"><span class="id" title="constructor">Con</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#tm:20"><span class="id" title="inductive">tm</span></a><br/>
| <a id="Div" class="idref" href="#Div"><span class="id" title="constructor">Div</span></a> : <a class="idref" href="Monads.Monads.html#tm:20"><span class="id" title="inductive">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#tm:20"><span class="id" title="inductive">tm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#tm:20"><span class="id" title="inductive">tm</span></a>.<br/>

<br/>
</div>

<div class="doc">
Following Wadler's paper, we fix our two favourite examples of terms 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a id="answer" class="idref" href="#answer"><span class="id" title="definition">answer</span></a>: <a class="idref" href="Monads.Monads.html#tm"><span class="id" title="inductive">tm</span></a> := (<a class="idref" href="Monads.Monads.html#Div"><span class="id" title="constructor">Div</span></a> (<a class="idref" href="Monads.Monads.html#Div"><span class="id" title="constructor">Div</span></a> (<a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> 1972 ) (<a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> 2 )) (<a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> 23 )).<br/>
<span class="id" title="keyword">Example</span> <a id="error" class="idref" href="#error"><span class="id" title="definition">error</span></a>: <a class="idref" href="Monads.Monads.html#tm"><span class="id" title="inductive">tm</span></a> := (<a class="idref" href="Monads.Monads.html#Div"><span class="id" title="constructor">Div</span></a> (<a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> 1)(<a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> 0)).<br/>

<br/>
</div>

<div class="doc">
<a id="lab5"></a><h1 class="section">The monad <span class="inlinecode"><span class="id" title="keyword">Type</span></span> <span class="inlinecode"><span class="id" title="keyword">Class</span></span></h1>

<div class="paragraph"> </div>

 Now we have to implement the concept of monad, and we do that using a <span class="inlinecode"><span class="id" title="keyword">Type</span></span> <span class="inlinecode"><span class="id" title="keyword">Class</span></span>. 
As we said earlier, a monad is not just a <i>functor</i> but has additional properties. 
In the following definition,
<ul class="doclist">
<li>  <span class="inlinecode"><a class="idref" href="Monads.StateTransformerMonad.html#ret"><span class="id" title="projection">ret</span></a></span> is to be thought of as a way to turn 
  a value into the computation that returns that value and does nothing else

</li>
<li> <span class="inlinecode"><a class="idref" href="Monads.StateTransformerMonad.html#bind"><span class="id" title="projection">bind</span></a></span> tells us how to apply a function of type <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">M</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> to a computation of type <span class="inlinecode"><span class="id" title="var">M</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span>.

</li>
</ul>

<div class="paragraph"> </div>

Following Wadler, <i>a monad is a triple (M,ret,bind) consisting of a type constructor M 
and two operations of the given polymorphic types</i>. Note that all the monads below a simplified 
reimplementations of the more refined instances of the <span class="inlinecode"><span class="id" title="var">ext</span>-<span class="id" title="var">lib</span></span> Coq library, 
 https://github.com/coq-community/coq-ext-lib. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Class</span> <a id="Monad" class="idref" href="#Monad"><span class="id" title="record">Monad</span></a>(<a id="M:22" class="idref" href="#M:22"><span class="id" title="binder">M</span></a>:<span class="id" title="keyword">Type</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Type</span>) := <br/>
{<br/>
&nbsp;&nbsp;<a id="ret" class="idref" href="#ret"><span class="id" title="projection">ret</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:24" class="idref" href="#A:24"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>}, <a class="idref" href="Monads.Monads.html#A:24"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#M:22"><span class="id" title="variable">M</span></a> <a class="idref" href="Monads.Monads.html#A:24"><span class="id" title="variable">A</span></a> ; <br/>
&nbsp;&nbsp;<a id="bind" class="idref" href="#bind"><span class="id" title="projection">bind</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:26" class="idref" href="#A:26"><span class="id" title="binder">A</span></a> <a id="B:27" class="idref" href="#B:27"><span class="id" title="binder">B</span></a>:<span class="id" title="keyword">Type</span>}, <a class="idref" href="Monads.Monads.html#M:22"><span class="id" title="variable">M</span></a> <a class="idref" href="Monads.Monads.html#A:26"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Monads.Monads.html#A:26"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#M:22"><span class="id" title="variable">M</span></a> <a class="idref" href="Monads.Monads.html#B:27"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#M:22"><span class="id" title="variable">M</span></a> <a class="idref" href="Monads.Monads.html#B:27"><span class="id" title="variable">B</span></a>; <br/>
}.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="f4c072b7f26484005a9e0c3986ed1f19" class="idref" href="#f4c072b7f26484005a9e0c3986ed1f19"><span class="id" title="notation">&quot;</span></a>x &lt;- c1 ;; c2" := (<a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <span class="id" title="var">c1</span> (<span class="id" title="keyword">fun</span> <a id="x:29" class="idref" href="#x:29"><span class="id" title="binder">x</span></a> =&gt; <span class="id" title="var">c2</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 84, <span class="id" title="var">c1</span> <span class="id" title="tactic">at</span> <span class="id" title="var">next</span> <span class="id" title="keyword">level</span>).<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="ddfa557d890d9c0cd173d40cb7db80da" class="idref" href="#ddfa557d890d9c0cd173d40cb7db80da"><span class="id" title="notation">&quot;</span></a>c1 ;; c2" := (<a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <span class="id" title="var">c1</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">c2</span>)) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>).<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="MonadLeft" class="idref" href="#MonadLeft"><span class="id" title="record">MonadLeft</span></a> (<a id="M:30" class="idref" href="#M:30"><span class="id" title="binder">M</span></a> : <span class="id" title="keyword">Type</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Type</span>) {<a id="H:31" class="idref" href="#H:31"><span class="id" title="binder">H</span></a> : <a class="idref" href="Monads.Monads.html#Monad"><span class="id" title="class">Monad</span></a> <a class="idref" href="Monads.Monads.html#M:30"><span class="id" title="variable">M</span></a>} := <br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;<a id="left_id_monad" class="idref" href="#left_id_monad"><span class="id" title="projection">left_id_monad</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:33" class="idref" href="#A:33"><span class="id" title="binder">A</span></a> <a id="B:34" class="idref" href="#B:34"><span class="id" title="binder">B</span></a>:<span class="id" title="keyword">Type</span>} (<a id="x:35" class="idref" href="#x:35"><span class="id" title="binder">x</span></a>:<a class="idref" href="Monads.Monads.html#A:33"><span class="id" title="variable">A</span></a>) (<a id="f:36" class="idref" href="#f:36"><span class="id" title="binder">f</span></a>:<a class="idref" href="Monads.Monads.html#A:33"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#M:30"><span class="id" title="variable">M</span></a> <a class="idref" href="Monads.Monads.html#B:34"><span class="id" title="variable">B</span></a>), <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> (<a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> <a class="idref" href="Monads.Monads.html#x:35"><span class="id" title="variable">x</span></a>) <a class="idref" href="Monads.Monads.html#f:36"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#f:36"><span class="id" title="variable">f</span></a> <a class="idref" href="Monads.Monads.html#x:35"><span class="id" title="variable">x</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="MonadRight" class="idref" href="#MonadRight"><span class="id" title="record">MonadRight</span></a> (<a id="M:38" class="idref" href="#M:38"><span class="id" title="binder">M</span></a> : <span class="id" title="keyword">Type</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Type</span>) {<a id="H:39" class="idref" href="#H:39"><span class="id" title="binder">H</span></a> : <a class="idref" href="Monads.Monads.html#Monad"><span class="id" title="class">Monad</span></a> <a class="idref" href="Monads.Monads.html#M:38"><span class="id" title="variable">M</span></a>} := <br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;<a id="right_id_monad" class="idref" href="#right_id_monad"><span class="id" title="projection">right_id_monad</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:41" class="idref" href="#A:41"><span class="id" title="binder">A</span></a> <a id="B:42" class="idref" href="#B:42"><span class="id" title="binder">B</span></a>:<span class="id" title="keyword">Type</span>} (<a id="c:43" class="idref" href="#c:43"><span class="id" title="binder">c</span></a>:<a class="idref" href="Monads.Monads.html#M:38"><span class="id" title="variable">M</span></a> <a class="idref" href="Monads.Monads.html#A:41"><span class="id" title="variable">A</span></a>), <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="Monads.Monads.html#c:43"><span class="id" title="variable">c</span></a> <a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#c:43"><span class="id" title="variable">c</span></a>                                                       }.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="MonadAssoc" class="idref" href="#MonadAssoc"><span class="id" title="record">MonadAssoc</span></a> (<a id="M:45" class="idref" href="#M:45"><span class="id" title="binder">M</span></a> : <span class="id" title="keyword">Type</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Type</span>) {<a id="H:46" class="idref" href="#H:46"><span class="id" title="binder">H</span></a> : <a class="idref" href="Monads.Monads.html#Monad"><span class="id" title="class">Monad</span></a> <a class="idref" href="Monads.Monads.html#M:45"><span class="id" title="variable">M</span></a>} := <br/>
&nbsp;&nbsp;{<br/>
&nbsp;<a id="assoc_monad" class="idref" href="#assoc_monad"><span class="id" title="projection">assoc_monad</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:48" class="idref" href="#A:48"><span class="id" title="binder">A</span></a> <a id="B:49" class="idref" href="#B:49"><span class="id" title="binder">B</span></a> <a id="C:50" class="idref" href="#C:50"><span class="id" title="binder">C</span></a>} (<a id="c:51" class="idref" href="#c:51"><span class="id" title="binder">c</span></a>:<a class="idref" href="Monads.Monads.html#M:45"><span class="id" title="variable">M</span></a> <a class="idref" href="Monads.Monads.html#A:48"><span class="id" title="variable">A</span></a>) (<a id="f:52" class="idref" href="#f:52"><span class="id" title="binder">f</span></a>:<a class="idref" href="Monads.Monads.html#A:48"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><a class="idref" href="Monads.Monads.html#M:45"><span class="id" title="variable">M</span></a> <a class="idref" href="Monads.Monads.html#B:49"><span class="id" title="variable">B</span></a>) (<a id="g:53" class="idref" href="#g:53"><span class="id" title="binder">g</span></a>:<a class="idref" href="Monads.Monads.html#B:49"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#M:45"><span class="id" title="variable">M</span></a> <a class="idref" href="Monads.Monads.html#C:50"><span class="id" title="variable">C</span></a>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> (<a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="Monads.Monads.html#c:51"><span class="id" title="variable">c</span></a> <a class="idref" href="Monads.Monads.html#f:52"><span class="id" title="variable">f</span></a>) <a class="idref" href="Monads.Monads.html#g:53"><span class="id" title="variable">g</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="Monads.Monads.html#c:51"><span class="id" title="variable">c</span></a> (<span class="id" title="keyword">fun</span> <a id="x:54" class="idref" href="#x:54"><span class="id" title="binder">x</span></a> =&gt; <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> (<a class="idref" href="Monads.Monads.html#f:52"><span class="id" title="variable">f</span></a> <a class="idref" href="Monads.Monads.html#x:54"><span class="id" title="variable">x</span></a>) <a class="idref" href="Monads.Monads.html#g:53"><span class="id" title="variable">g</span></a>)                                                      <br/>
}.<br/>

<br/>
<span class="comment">(*&nbsp;Not&nbsp;sure&nbsp;what&nbsp;this&nbsp;does*)</span><br/>
<span class="id" title="keyword">Class</span> <a id="MonadLaws" class="idref" href="#MonadLaws"><span class="id" title="record">MonadLaws</span></a> (<a id="M:56" class="idref" href="#M:56"><span class="id" title="binder">M</span></a> : <span class="id" title="keyword">Type</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Type</span>) {<a id="H:57" class="idref" href="#H:57"><span class="id" title="binder">H</span></a> : <a class="idref" href="Monads.Monads.html#Monad"><span class="id" title="class">Monad</span></a> <a class="idref" href="Monads.Monads.html#M:56"><span class="id" title="variable">M</span></a>} :=<br/>
&nbsp;&nbsp;{ <a id="M_Left" class="idref" href="#M_Left"><span class="id" title="projection">M_Left</span></a> :&gt; <a class="idref" href="Monads.Monads.html#MonadLeft"><span class="id" title="class">MonadLeft</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="M_Right" class="idref" href="#M_Right"><span class="id" title="projection">M_Right</span></a> :&gt; <a class="idref" href="Monads.Monads.html#MonadRight"><span class="id" title="class">MonadRight</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="M_Assoc" class="idref" href="#M_Assoc"><span class="id" title="projection">M_Assoc</span></a> :&gt; <a class="idref" href="Monads.Monads.html#MonadAssoc"><span class="id" title="class">MonadAssoc</span></a>}.<br/>

<br/>
</div>

<div class="doc">
<a id="lab6"></a><h1 class="section">The exception monad</h1>

<div class="paragraph"> </div>

  We are ready to see our first example of monad: the exception monad. Since we are
performing division between natural numbers we want to make sure that we never divide by zero and 
that whenever <span class="inlinecode">0</span> is at the denominator of a fraction, we raise an exception. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a id="Exn" class="idref" href="#Exn"><span class="id" title="inductive">Exn</span></a>(<a id="A:62" class="idref" href="#A:62"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> := <br/>
| <a id="Result" class="idref" href="#Result"><span class="id" title="constructor">Result</span></a> : <a class="idref" href="Monads.Monads.html#A:62"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#Exn:63"><span class="id" title="inductive">Exn</span></a> <a class="idref" href="Monads.Monads.html#A:62"><span class="id" title="variable">A</span></a><br/>
| <a id="Fail" class="idref" href="#Fail"><span class="id" title="constructor">Fail</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#Exn:63"><span class="id" title="inductive">Exn</span></a> <a class="idref" href="Monads.Monads.html#A:62"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="var">Arguments</span> <a class="idref" href="Monads.Monads.html#Result"><span class="id" title="constructor">Result</span></a> {<span class="id" title="var">A</span>}.<br/>
<span class="id" title="var">Arguments</span> <a class="idref" href="Monads.Monads.html#Fail"><span class="id" title="constructor">Fail</span></a> {<span class="id" title="var">A</span>}.<br/>

<br/>
</div>

<div class="doc">
For now, <span class="inlinecode"><a class="idref" href="Monads.Monads.html#Exn"><span class="id" title="inductive">Exn</span></a></span> is just a "function" that takes a type and produces an exception of that type. 
To turn it into a monad we need to provide a definition of the <span class="inlinecode"><a class="idref" href="Monads.StateTransformerMonad.html#ret"><span class="id" title="projection">ret</span></a></span> and <span class="inlinecode"><a class="idref" href="Monads.StateTransformerMonad.html#bind"><span class="id" title="projection">bind</span></a></span> functions. 
</div>
<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Program.Tactics.html#"><span class="id" title="library">Program.Tactics</span></a>.<br/>
<span class="id" title="keyword">Instance</span> <a id="ExnMonad" class="idref" href="#ExnMonad"><span class="id" title="instance">ExnMonad</span></a> : <a class="idref" href="Monads.Monads.html#Monad"><span class="id" title="class">Monad</span></a> <a class="idref" href="Monads.Monads.html#Exn"><span class="id" title="inductive">Exn</span></a> := <br/>
{<br/>
&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> := <span class="id" title="keyword">fun</span> {<a id="A:65" class="idref" href="#A:65"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>} (<a id="x:66" class="idref" href="#x:66"><span class="id" title="binder">x</span></a>:<a class="idref" href="Monads.Monads.html#A:65"><span class="id" title="variable">A</span></a>) =&gt; <a class="idref" href="Monads.Monads.html#Result"><span class="id" title="constructor">Result</span></a> <a class="idref" href="Monads.Monads.html#x:66"><span class="id" title="variable">x</span></a> ; <br/>
&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> := <span class="id" title="keyword">fun</span> {<a id="A:67" class="idref" href="#A:67"><span class="id" title="binder">A</span></a> <a id="B:68" class="idref" href="#B:68"><span class="id" title="binder">B</span></a>:<span class="id" title="keyword">Type</span>} (<a id="x:69" class="idref" href="#x:69"><span class="id" title="binder">x</span></a>:<a class="idref" href="Monads.Monads.html#Exn"><span class="id" title="inductive">Exn</span></a> <a class="idref" href="Monads.Monads.html#A:67"><span class="id" title="variable">A</span></a>) (<a id="f:70" class="idref" href="#f:70"><span class="id" title="binder">f</span></a>:<a class="idref" href="Monads.Monads.html#A:67"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#Exn"><span class="id" title="inductive">Exn</span></a> <a class="idref" href="Monads.Monads.html#B:68"><span class="id" title="variable">B</span></a>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#x:69"><span class="id" title="variable">x</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Result"><span class="id" title="constructor">Result</span></a> <span class="id" title="var">y</span> =&gt; <a class="idref" href="Monads.Monads.html#f:70"><span class="id" title="variable">f</span></a> <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Fail"><span class="id" title="constructor">Fail</span></a> <span class="id" title="var">s</span> =&gt; <a class="idref" href="Monads.Monads.html#Fail"><span class="id" title="constructor">Fail</span></a> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
}.<br/>

<br/>
</div>

<div class="doc">
But, theoretically speaking, providing a definition of the <span class="inlinecode"><a class="idref" href="Monads.StateTransformerMonad.html#ret"><span class="id" title="projection">ret</span></a></span> and <span class="inlinecode"><a class="idref" href="Monads.StateTransformerMonad.html#bind"><span class="id" title="projection">bind</span></a></span> functions is not 
enough to claim that <span class="inlinecode"><a class="idref" href="Monads.Monads.html#ExnMonad"><span class="id" title="instance">ExnMonad</span></a></span> is indeed a monad. We need to prove that <span class="inlinecode"><a class="idref" href="Monads.StateTransformerMonad.html#ret"><span class="id" title="projection">ret</span></a></span> and <span class="inlinecode"><a class="idref" href="Monads.StateTransformerMonad.html#bind"><span class="id" title="projection">bind</span></a></span> satisfy
the properties for a functor to be a monad: namely, unitarity and associativity. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="m_left_id_exn_monad" class="idref" href="#m_left_id_exn_monad"><span class="id" title="lemma">m_left_id_exn_monad</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:72" class="idref" href="#A:72"><span class="id" title="binder">A</span></a> <a id="B:73" class="idref" href="#B:73"><span class="id" title="binder">B</span></a>:<span class="id" title="keyword">Type</span>} (<a id="x:74" class="idref" href="#x:74"><span class="id" title="binder">x</span></a>:<a class="idref" href="Monads.Monads.html#A:72"><span class="id" title="variable">A</span></a>) (<a id="f:75" class="idref" href="#f:75"><span class="id" title="binder">f</span></a>:<a class="idref" href="Monads.Monads.html#A:72"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#Exn"><span class="id" title="inductive">Exn</span></a> <a class="idref" href="Monads.Monads.html#B:73"><span class="id" title="variable">B</span></a>), <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> (<a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> <a class="idref" href="Monads.Monads.html#x:74"><span class="id" title="variable">x</span></a>) <a class="idref" href="Monads.Monads.html#f:75"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#f:75"><span class="id" title="variable">f</span></a> <a class="idref" href="Monads.Monads.html#x:74"><span class="id" title="variable">x</span></a> .<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">trivial</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="m_right_id_exn_monad" class="idref" href="#m_right_id_exn_monad"><span class="id" title="lemma">m_right_id_exn_monad</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:76" class="idref" href="#A:76"><span class="id" title="binder">A</span></a> <a id="B:77" class="idref" href="#B:77"><span class="id" title="binder">B</span></a>:<span class="id" title="keyword">Type</span>} (<a id="c:78" class="idref" href="#c:78"><span class="id" title="binder">c</span></a>:<a class="idref" href="Monads.Monads.html#Exn"><span class="id" title="inductive">Exn</span></a> <a class="idref" href="Monads.Monads.html#A:76"><span class="id" title="variable">A</span></a>), <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="Monads.Monads.html#c:78"><span class="id" title="variable">c</span></a> <a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#c:78"><span class="id" title="variable">c</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>; <span class="id" title="tactic">trivial</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="m_assoc_exn_monad" class="idref" href="#m_assoc_exn_monad"><span class="id" title="lemma">m_assoc_exn_monad</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:79" class="idref" href="#A:79"><span class="id" title="binder">A</span></a> <a id="B:80" class="idref" href="#B:80"><span class="id" title="binder">B</span></a> <a id="C:81" class="idref" href="#C:81"><span class="id" title="binder">C</span></a>} (<a id="c:82" class="idref" href="#c:82"><span class="id" title="binder">c</span></a>:<a class="idref" href="Monads.Monads.html#Exn"><span class="id" title="inductive">Exn</span></a> <a class="idref" href="Monads.Monads.html#A:79"><span class="id" title="variable">A</span></a>) (<a id="f:83" class="idref" href="#f:83"><span class="id" title="binder">f</span></a>:<a class="idref" href="Monads.Monads.html#A:79"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><a class="idref" href="Monads.Monads.html#Exn"><span class="id" title="inductive">Exn</span></a> <a class="idref" href="Monads.Monads.html#B:80"><span class="id" title="variable">B</span></a>) (<a id="g:84" class="idref" href="#g:84"><span class="id" title="binder">g</span></a>:<a class="idref" href="Monads.Monads.html#B:80"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#Exn"><span class="id" title="inductive">Exn</span></a> <a class="idref" href="Monads.Monads.html#C:81"><span class="id" title="variable">C</span></a>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> (<a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="Monads.Monads.html#c:82"><span class="id" title="variable">c</span></a> <a class="idref" href="Monads.Monads.html#f:83"><span class="id" title="variable">f</span></a>) <a class="idref" href="Monads.Monads.html#g:84"><span class="id" title="variable">g</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="Monads.Monads.html#c:82"><span class="id" title="variable">c</span></a> (<span class="id" title="keyword">fun</span> <a id="x:85" class="idref" href="#x:85"><span class="id" title="binder">x</span></a> =&gt; <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> (<a class="idref" href="Monads.Monads.html#f:83"><span class="id" title="variable">f</span></a> <a class="idref" href="Monads.Monads.html#x:85"><span class="id" title="variable">x</span></a>) <a class="idref" href="Monads.Monads.html#g:84"><span class="id" title="variable">g</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>); <span class="id" title="tactic">try</span> <span class="id" title="tactic">trivial</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
We now exploit the power of <span class="inlinecode"><a class="idref" href="Monads.Monads.html#ExnMonad"><span class="id" title="instance">ExnMonad</span></a></span> and use it to write an evaluator of the 
language of terms defined above.
<div class="paragraph"> </div>

 The type <span class="inlinecode"><a class="idref" href="Monads.Monads.html#tm"><span class="id" title="inductive">tm</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Monads.Monads.html#Exn"><span class="id" title="inductive">Exn</span></a></span> <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a></span> indicates that the evaluator takes a term and performs a computation 
yielding a natural number. To compute <span class="inlinecode"><a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a></span> <span class="inlinecode"><span class="id" title="var">n</span></span>, just return <span class="inlinecode"><span class="id" title="var">n</span></span>. To compute <span class="inlinecode"><a class="idref" href="Monads.Monads.html#Div"><span class="id" title="constructor">Div</span></a></span> <span class="inlinecode"><span class="id" title="var">t1</span></span> <span class="inlinecode"><span class="id" title="var">t2</span></span>, 
first compute <span class="inlinecode"><span class="id" title="var">t1</span></span>, bind <span class="inlinecode"><span class="id" title="var">n1</span></span> to the result, then compute <span class="inlinecode"><span class="id" title="var">t2</span></span>, bind <span class="inlinecode"><span class="id" title="var">n2</span></span> to the result and verify
whether the division can be performed.
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="eval_exn" class="idref" href="#eval_exn"><span class="id" title="definition">eval_exn</span></a> (<a id="t:86" class="idref" href="#t:86"><span class="id" title="binder">t</span></a>:<a class="idref" href="Monads.Monads.html#tm"><span class="id" title="inductive">tm</span></a>) : <a class="idref" href="Monads.Monads.html#Exn"><span class="id" title="inductive">Exn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#t:86"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> <span class="id" title="var">n</span> =&gt; <a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Div"><span class="id" title="constructor">Div</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; <a id="n1:89" class="idref" href="#n1:89"><span class="id" title="binder">n1</span></a> <a class="idref" href="Monads.Monads.html#f4c072b7f26484005a9e0c3986ed1f19"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Monads.Monads.html#eval_exn:87"><span class="id" title="definition">eval_exn</span></a> <span class="id" title="var">t1</span> <a class="idref" href="Monads.Monads.html#f4c072b7f26484005a9e0c3986ed1f19"><span class="id" title="notation">;;</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="n2:90" class="idref" href="#n2:90"><span class="id" title="binder">n2</span></a> <a class="idref" href="Monads.Monads.html#f4c072b7f26484005a9e0c3986ed1f19"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Monads.Monads.html#eval_exn:87"><span class="id" title="definition">eval_exn</span></a> <span class="id" title="var">t2</span> <a class="idref" href="Monads.Monads.html#f4c072b7f26484005a9e0c3986ed1f19"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#n2:90"><span class="id" title="variable">n2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <a class="idref" href="Monads.Monads.html#Fail"><span class="id" title="constructor">Fail</span></a> "division by zero!"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> (<a class="idref" href="Monads.Monads.html#n1:89"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.PeanoNat.html#2e0d8202c5a48097752d760d3a1db6a7"><span class="id" title="notation">/</span></a> <a class="idref" href="Monads.Monads.html#n2:90"><span class="id" title="variable">n2</span></a>) <span class="id" title="keyword">end</span> <span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="Monads.Monads.html#eval_exn"><span class="id" title="definition">eval_exn</span></a>(<a class="idref" href="Monads.Monads.html#answer"><span class="id" title="definition">answer</span></a>).<br/>
<span class="comment">(*&nbsp;=&nbsp;Result&nbsp;42<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Exn&nbsp;nat&nbsp;*)</span><br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="Monads.Monads.html#eval_exn"><span class="id" title="definition">eval_exn</span></a>(<a class="idref" href="Monads.Monads.html#error"><span class="id" title="definition">error</span></a>).<br/>
<span class="comment">(*&nbsp;=&nbsp;Fail&nbsp;"division&nbsp;by&nbsp;zero!"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Exn&nbsp;nat&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
It is possible to implement an evalutator handling exception <i>without</i> the use of the Exception Monad. 
This is done as follows: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="eval_exn_no_monad" class="idref" href="#eval_exn_no_monad"><span class="id" title="definition">eval_exn_no_monad</span></a> (<a id="t:92" class="idref" href="#t:92"><span class="id" title="binder">t</span></a>:<a class="idref" href="Monads.Monads.html#tm"><span class="id" title="inductive">tm</span></a>) : <a class="idref" href="Monads.Monads.html#Exn"><span class="id" title="inductive">Exn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#t:92"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> <span class="id" title="var">n</span> =&gt; <a class="idref" href="Monads.Monads.html#Result"><span class="id" title="constructor">Result</span></a> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Div"><span class="id" title="constructor">Div</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#eval_exn_no_monad:93"><span class="id" title="definition">eval_exn_no_monad</span></a> <span class="id" title="var">t1</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Fail"><span class="id" title="constructor">Fail</span></a> <span class="id" title="var">s</span>    =&gt; <a class="idref" href="Monads.Monads.html#Fail"><span class="id" title="constructor">Fail</span></a> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Result"><span class="id" title="constructor">Result</span></a> <span class="id" title="var">n1</span> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#eval_exn_no_monad:93"><span class="id" title="definition">eval_exn_no_monad</span></a> <span class="id" title="var">t2</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Fail"><span class="id" title="constructor">Fail</span></a> <span class="id" title="var">s</span>    =&gt; <a class="idref" href="Monads.Monads.html#Fail"><span class="id" title="constructor">Fail</span></a> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Result"><span class="id" title="constructor">Result</span></a> <span class="id" title="var">n2</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">n2</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <a class="idref" href="Monads.Monads.html#Fail"><span class="id" title="constructor">Fail</span></a> "division by zero!"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="Monads.Monads.html#Result"><span class="id" title="constructor">Result</span></a> (<span class="id" title="var">n1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.PeanoNat.html#2e0d8202c5a48097752d760d3a1db6a7"><span class="id" title="notation">/</span></a><span class="id" title="var">n2</span>) <span class="id" title="keyword">end</span> <span class="id" title="keyword">end</span> <span class="id" title="keyword">end</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="Monads.Monads.html#eval_exn_no_monad"><span class="id" title="definition">eval_exn_no_monad</span></a>(<a class="idref" href="Monads.Monads.html#answer"><span class="id" title="definition">answer</span></a>).<br/>
<span class="comment">(*&nbsp;=&nbsp;Result&nbsp;42<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Exn&nbsp;nat&nbsp;*)</span><br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="Monads.Monads.html#eval_exn_no_monad"><span class="id" title="definition">eval_exn_no_monad</span></a>(<a class="idref" href="Monads.Monads.html#error"><span class="id" title="definition">error</span></a>).<br/>
<span class="comment">(*&nbsp;=&nbsp;Fail&nbsp;"division&nbsp;by&nbsp;zero!"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Exn&nbsp;nat&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="eval_exn_equiv" class="idref" href="#eval_exn_equiv"><span class="id" title="lemma">eval_exn_equiv</span></a>: <span class="id" title="keyword">forall</span> <a id="t:96" class="idref" href="#t:96"><span class="id" title="binder">t</span></a>, <a class="idref" href="Monads.Monads.html#eval_exn"><span class="id" title="definition">eval_exn</span></a> <a class="idref" href="Monads.Monads.html#t:96"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#eval_exn_no_monad"><span class="id" title="definition">eval_exn_no_monad</span></a> <a class="idref" href="Monads.Monads.html#t:96"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>.<br/>
- <span class="id" title="tactic">auto</span>.<br/>
- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt2</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab7"></a><h1 class="section">The (simple) state monad</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a id="simple_monad_state" class="idref" href="#simple_monad_state"><span class="id" title="module">simple_monad_state</span></a>.<br/>

<br/>
</div>

<div class="doc">
In the state monad, a computation accepts 
an initial state and returns a value paired with the final state. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="simple_monad_state.state" class="idref" href="#simple_monad_state.state"><span class="id" title="definition">state</span></a>:=<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a id="simple_monad_state.state_comp" class="idref" href="#simple_monad_state.state_comp"><span class="id" title="definition">state_comp</span></a>(<a id="A:97" class="idref" href="#A:97"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) := <a class="idref" href="Monads.Monads.html#simple_monad_state.state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Monads.Monads.html#simple_monad_state.state"><span class="id" title="definition">state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a><a class="idref" href="Monads.Monads.html#A:97"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <a id="simple_monad_state.StateMonad" class="idref" href="#simple_monad_state.StateMonad"><span class="id" title="instance">StateMonad</span></a> : <a class="idref" href="Monads.Monads.html#Monad"><span class="id" title="class">Monad</span></a> <a class="idref" href="Monads.Monads.html#simple_monad_state.state_comp"><span class="id" title="definition">state_comp</span></a> := {<br/>
&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> := <span class="id" title="keyword">fun</span> {<a id="A:98" class="idref" href="#A:98"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>} (<a id="x:99" class="idref" href="#x:99"><span class="id" title="binder">x</span></a>:<a class="idref" href="Monads.Monads.html#A:98"><span class="id" title="variable">A</span></a>) =&gt; (<span class="id" title="keyword">fun</span> (<a id="s:100" class="idref" href="#s:100"><span class="id" title="binder">s</span></a>:<a class="idref" href="Monads.Monads.html#simple_monad_state.state"><span class="id" title="definition">state</span></a>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Monads.Monads.html#s:100"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="Monads.Monads.html#x:99"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) ; <br/>
&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> := <span class="id" title="keyword">fun</span> {<a id="A:101" class="idref" href="#A:101"><span class="id" title="binder">A</span></a> <a id="B:102" class="idref" href="#B:102"><span class="id" title="binder">B</span></a>:<span class="id" title="keyword">Type</span>} (<a id="c:103" class="idref" href="#c:103"><span class="id" title="binder">c</span></a> : <a class="idref" href="Monads.Monads.html#simple_monad_state.state_comp"><span class="id" title="definition">state_comp</span></a> <a class="idref" href="Monads.Monads.html#A:101"><span class="id" title="variable">A</span></a>) (<a id="f:104" class="idref" href="#f:104"><span class="id" title="binder">f</span></a>: <a class="idref" href="Monads.Monads.html#A:101"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#simple_monad_state.state_comp"><span class="id" title="definition">state_comp</span></a> <a class="idref" href="Monads.Monads.html#B:102"><span class="id" title="variable">B</span></a>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> (<a id="s:105" class="idref" href="#s:105"><span class="id" title="binder">s</span></a>:<a class="idref" href="Monads.Monads.html#simple_monad_state.state"><span class="id" title="definition">state</span></a>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="s':106" class="idref" href="#s':106"><span class="id" title="binder">s'</span></a>,<a id="v:107" class="idref" href="#v:107"><span class="id" title="binder">v</span></a>) := <a class="idref" href="Monads.Monads.html#c:103"><span class="id" title="variable">c</span></a> <a class="idref" href="Monads.Monads.html#s:105"><span class="id" title="variable">s</span></a> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#f:104"><span class="id" title="variable">f</span></a> <a class="idref" href="Monads.Monads.html#v:107"><span class="id" title="variable">v</span></a> <a class="idref" href="Monads.Monads.html#s':106"><span class="id" title="variable">s'</span></a><br/>
}.<br/>

<br/>
</div>

<div class="doc">
As well as for the exception monad, we need to prove that <span class="inlinecode"><a class="idref" href="Monads.StateTransformerMonad.html#StateMonad"><span class="id" title="instance">StateMonad</span></a></span> satisfy 
the three relevant properties below. Note that in the proofs, we had to make use of the 
functional exptensionality axiom. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="simple_monad_state.m_left_id_state_monad" class="idref" href="#simple_monad_state.m_left_id_state_monad"><span class="id" title="lemma">m_left_id_state_monad</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:108" class="idref" href="#A:108"><span class="id" title="binder">A</span></a> <a id="B:109" class="idref" href="#B:109"><span class="id" title="binder">B</span></a>:<span class="id" title="keyword">Type</span>} (<a id="x:110" class="idref" href="#x:110"><span class="id" title="binder">x</span></a>:<a class="idref" href="Monads.Monads.html#A:108"><span class="id" title="variable">A</span></a>) (<a id="f:111" class="idref" href="#f:111"><span class="id" title="binder">f</span></a>:<a class="idref" href="Monads.Monads.html#A:108"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#simple_monad_state.state_comp"><span class="id" title="definition">state_comp</span></a> <a class="idref" href="Monads.Monads.html#B:109"><span class="id" title="variable">B</span></a>), <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> (<a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> <a class="idref" href="Monads.Monads.html#x:110"><span class="id" title="variable">x</span></a>) <a class="idref" href="Monads.Monads.html#f:111"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#f:111"><span class="id" title="variable">f</span></a> <a class="idref" href="Monads.Monads.html#x:110"><span class="id" title="variable">x</span></a> .<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Monads.Monads.html#functional_extensionality"><span class="id" title="axiom">functional_extensionality</span></a>. <span class="id" title="tactic">trivial</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="simple_monad_state.m_right_id_state_monad" class="idref" href="#simple_monad_state.m_right_id_state_monad"><span class="id" title="lemma">m_right_id_state_monad</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:112" class="idref" href="#A:112"><span class="id" title="binder">A</span></a> <a id="B:113" class="idref" href="#B:113"><span class="id" title="binder">B</span></a>:<span class="id" title="keyword">Type</span>} (<a id="c:114" class="idref" href="#c:114"><span class="id" title="binder">c</span></a>:<a class="idref" href="Monads.Monads.html#simple_monad_state.state_comp"><span class="id" title="definition">state_comp</span></a> <a class="idref" href="Monads.Monads.html#A:112"><span class="id" title="variable">A</span></a>), <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="Monads.Monads.html#c:114"><span class="id" title="variable">c</span></a> <a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#c:114"><span class="id" title="variable">c</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Monads.Monads.html#functional_extensionality"><span class="id" title="axiom">functional_extensionality</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">trivial</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="simple_monad_state.m_assoc_state_monad" class="idref" href="#simple_monad_state.m_assoc_state_monad"><span class="id" title="lemma">m_assoc_state_monad</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:115" class="idref" href="#A:115"><span class="id" title="binder">A</span></a> <a id="B:116" class="idref" href="#B:116"><span class="id" title="binder">B</span></a> <a id="C:117" class="idref" href="#C:117"><span class="id" title="binder">C</span></a>} (<a id="c:118" class="idref" href="#c:118"><span class="id" title="binder">c</span></a>:<a class="idref" href="Monads.Monads.html#simple_monad_state.state_comp"><span class="id" title="definition">state_comp</span></a> <a class="idref" href="Monads.Monads.html#A:115"><span class="id" title="variable">A</span></a>) (<a id="f:119" class="idref" href="#f:119"><span class="id" title="binder">f</span></a>:<a class="idref" href="Monads.Monads.html#A:115"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><a class="idref" href="Monads.Monads.html#simple_monad_state.state_comp"><span class="id" title="definition">state_comp</span></a> <a class="idref" href="Monads.Monads.html#B:116"><span class="id" title="variable">B</span></a>) (<a id="g:120" class="idref" href="#g:120"><span class="id" title="binder">g</span></a>:<a class="idref" href="Monads.Monads.html#B:116"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#simple_monad_state.state_comp"><span class="id" title="definition">state_comp</span></a> <a class="idref" href="Monads.Monads.html#C:117"><span class="id" title="variable">C</span></a>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> (<a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="Monads.Monads.html#c:118"><span class="id" title="variable">c</span></a> <a class="idref" href="Monads.Monads.html#f:119"><span class="id" title="variable">f</span></a>) <a class="idref" href="Monads.Monads.html#g:120"><span class="id" title="variable">g</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="Monads.Monads.html#c:118"><span class="id" title="variable">c</span></a> (<span class="id" title="keyword">fun</span> <a id="x:121" class="idref" href="#x:121"><span class="id" title="binder">x</span></a> =&gt; <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> (<a class="idref" href="Monads.Monads.html#f:119"><span class="id" title="variable">f</span></a> <a class="idref" href="Monads.Monads.html#x:121"><span class="id" title="variable">x</span></a>) <a class="idref" href="Monads.Monads.html#g:120"><span class="id" title="variable">g</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Monads.Monads.html#functional_extensionality"><span class="id" title="axiom">functional_extensionality</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">c</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">trivial</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="simple_monad_state.eval_state" class="idref" href="#simple_monad_state.eval_state"><span class="id" title="definition">eval_state</span></a> (<a id="t:122" class="idref" href="#t:122"><span class="id" title="binder">t</span></a>:<a class="idref" href="Monads.Monads.html#tm"><span class="id" title="inductive">tm</span></a>) : <a class="idref" href="Monads.Monads.html#simple_monad_state.state_comp"><span class="id" title="definition">state_comp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>  := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#t:122"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> <span class="id" title="var">n</span> =&gt; <a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Div"><span class="id" title="constructor">Div</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>  =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="n1:125" class="idref" href="#n1:125"><span class="id" title="binder">n1</span></a> <a class="idref" href="Monads.Monads.html#f4c072b7f26484005a9e0c3986ed1f19"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Monads.Monads.html#eval_state:123"><span class="id" title="definition">eval_state</span></a> <span class="id" title="var">t1</span> <a class="idref" href="Monads.Monads.html#f4c072b7f26484005a9e0c3986ed1f19"><span class="id" title="notation">;;</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="n2:126" class="idref" href="#n2:126"><span class="id" title="binder">n2</span></a> <a class="idref" href="Monads.Monads.html#f4c072b7f26484005a9e0c3986ed1f19"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Monads.Monads.html#eval_state:123"><span class="id" title="definition">eval_state</span></a> <span class="id" title="var">t2</span> <a class="idref" href="Monads.Monads.html#f4c072b7f26484005a9e0c3986ed1f19"><span class="id" title="notation">;;</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> (<a id="s:127" class="idref" href="#s:127"><span class="id" title="binder">s</span></a>:<a class="idref" href="Monads.Monads.html#simple_monad_state.state"><span class="id" title="definition">state</span></a>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a> <a class="idref" href="Monads.Monads.html#s:127"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1 <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Monads.Monads.html#n1:125"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.PeanoNat.html#2e0d8202c5a48097752d760d3a1db6a7"><span class="id" title="notation">/</span></a> <a class="idref" href="Monads.Monads.html#n2:126"><span class="id" title="variable">n2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="Monads.Monads.html#simple_monad_state.eval_state"><span class="id" title="definition">eval_state</span></a> <a class="idref" href="Monads.Monads.html#answer"><span class="id" title="definition">answer</span></a> 0.<br/>

<br/>
<span class="comment">(*&nbsp;=&nbsp;(2,&nbsp;42)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;state&nbsp;*&nbsp;nat&nbsp;*)</span><br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="Monads.Monads.html#simple_monad_state.eval_state"><span class="id" title="definition">eval_state</span></a> <a class="idref" href="Monads.Monads.html#error"><span class="id" title="definition">error</span></a> 0.<br/>

<br/>
<span class="comment">(*&nbsp;&nbsp;=&nbsp;(1,&nbsp;0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;state&nbsp;*&nbsp;nat<br/>
*)</span><br/>

<br/>
</div>

<div class="doc">
The follwing is an an alternative implementation of <span class="inlinecode"><a class="idref" href="Monads.Monads.html#simple_monad_state.eval_state"><span class="id" title="definition">eval_state</span></a></span> that does not make use of the StateMonad. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="simple_monad_state.eval_state_no_monad" class="idref" href="#simple_monad_state.eval_state_no_monad"><span class="id" title="definition">eval_state_no_monad</span></a> (<a id="t:128" class="idref" href="#t:128"><span class="id" title="binder">t</span></a>:<a class="idref" href="Monads.Monads.html#tm"><span class="id" title="inductive">tm</span></a>) : <a class="idref" href="Monads.Monads.html#simple_monad_state.state_comp"><span class="id" title="definition">state_comp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>  := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#t:128"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> <span class="id" title="var">n</span> =&gt; <span class="id" title="keyword">fun</span> <a id="s:131" class="idref" href="#s:131"><span class="id" title="binder">s</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Monads.Monads.html#s:131"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Div"><span class="id" title="constructor">Div</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>  =&gt; <span class="id" title="keyword">fun</span> <a id="s:132" class="idref" href="#s:132"><span class="id" title="binder">s</span></a> =&gt; <span class="id" title="keyword">let</span> (<a id="s':133" class="idref" href="#s':133"><span class="id" title="binder">s'</span></a>, <a id="n1:134" class="idref" href="#n1:134"><span class="id" title="binder">n1</span></a>):= <a class="idref" href="Monads.Monads.html#eval_state_no_monad:129"><span class="id" title="definition">eval_state_no_monad</span></a> <span class="id" title="var">t1</span> <a class="idref" href="Monads.Monads.html#s:132"><span class="id" title="variable">s</span></a> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="s'':135" class="idref" href="#s'':135"><span class="id" title="binder">s''</span></a>, <a id="n2:136" class="idref" href="#n2:136"><span class="id" title="binder">n2</span></a>):= <a class="idref" href="Monads.Monads.html#eval_state_no_monad:129"><span class="id" title="definition">eval_state_no_monad</span></a> <span class="id" title="var">t2</span> <a class="idref" href="Monads.Monads.html#s':133"><span class="id" title="variable">s'</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Monads.Monads.html#s'':135"><span class="id" title="variable">s''</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Monads.Monads.html#n1:134"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.PeanoNat.html#2e0d8202c5a48097752d760d3a1db6a7"><span class="id" title="notation">/</span></a><a class="idref" href="Monads.Monads.html#n2:136"><span class="id" title="variable">n2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="Monads.Monads.html#simple_monad_state.eval_state_no_monad"><span class="id" title="definition">eval_state_no_monad</span></a> <a class="idref" href="Monads.Monads.html#answer"><span class="id" title="definition">answer</span></a> 0.<br/>

<br/>
<span class="comment">(*&nbsp;=&nbsp;(2,&nbsp;42)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;state&nbsp;*&nbsp;nat&nbsp;*)</span><br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="Monads.Monads.html#simple_monad_state.eval_state_no_monad"><span class="id" title="definition">eval_state_no_monad</span></a> <a class="idref" href="Monads.Monads.html#error"><span class="id" title="definition">error</span></a> 0.<br/>

<br/>
<span class="comment">(*&nbsp;&nbsp;=&nbsp;(1,&nbsp;0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;state&nbsp;*&nbsp;nat<br/>
*)</span><br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="simple_monad_state.eval_state_equiv" class="idref" href="#simple_monad_state.eval_state_equiv"><span class="id" title="lemma">eval_state_equiv</span></a>: <span class="id" title="keyword">forall</span> <a id="t:137" class="idref" href="#t:137"><span class="id" title="binder">t</span></a>, <a class="idref" href="Monads.Monads.html#simple_monad_state.eval_state"><span class="id" title="definition">eval_state</span></a> <a class="idref" href="Monads.Monads.html#t:137"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#simple_monad_state.eval_state_no_monad"><span class="id" title="definition">eval_state_no_monad</span></a> <a class="idref" href="Monads.Monads.html#t:137"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>.<br/>
- <span class="id" title="tactic">auto</span>.<br/>
- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt2</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Monads.Monads.html#functional_extensionality"><span class="id" title="axiom">functional_extensionality</span></a>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">destruct</span> (<a class="idref" href="Monads.Monads.html#simple_monad_state.eval_state_no_monad"><span class="id" title="definition">eval_state_no_monad</span></a> <span class="id" title="var">t1</span>). <span class="id" title="tactic">destruct</span> (<a class="idref" href="Monads.Monads.html#simple_monad_state.eval_state_no_monad"><span class="id" title="definition">eval_state_no_monad</span></a> <span class="id" title="var">t2</span>). <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
We shall come back to the state monad, when dealing with a slightly more complicated language, 
a simplified version of <span class="inlinecode"><span class="id" title="var">IMP</span></span>, where we shall use a more refined definition of state. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Monads.Monads.html#simple_monad_state"><span class="id" title="module">simple_monad_state</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab8"></a><h1 class="section">The output monad</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Instance</span> <a id="expShow" class="idref" href="#expShow"><span class="id" title="instance">expShow</span></a> : <a class="idref" href="Monads.Monads.html#Show"><span class="id" title="class">Show</span></a> <a class="idref" href="Monads.Monads.html#tm"><span class="id" title="inductive">tm</span></a> := {<br/>
&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#show"><span class="id" title="method">show</span></a> := <span class="id" title="keyword">fix</span> <span class="id" title="var">show_exp</span> (<a id="t:138" class="idref" href="#t:138"><span class="id" title="binder">t</span></a>:<a class="idref" href="Monads.Monads.html#tm"><span class="id" title="inductive">tm</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#t:138"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> <span class="id" title="var">n</span> =&gt; "(Con "<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#169ad156fbc6036a53a0338819a2b301"><span class="id" title="notation">++</span></a> <a class="idref" href="Monads.Monads.html#show"><span class="id" title="method">show</span></a> <span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#169ad156fbc6036a53a0338819a2b301"><span class="id" title="notation">++</span></a>")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Div"><span class="id" title="constructor">Div</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> =&gt; "(Div " <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#169ad156fbc6036a53a0338819a2b301"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#169ad156fbc6036a53a0338819a2b301"><span class="id" title="notation">(</span></a><a class="idref" href="Monads.Monads.html#show_exp:139"><span class="id" title="variable">show_exp</span></a> <span class="id" title="var">t1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#169ad156fbc6036a53a0338819a2b301"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#169ad156fbc6036a53a0338819a2b301"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#169ad156fbc6036a53a0338819a2b301"><span class="id" title="notation">(</span></a><a class="idref" href="Monads.Monads.html#show_exp:139"><span class="id" title="variable">show_exp</span></a> <span class="id" title="var">t2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#169ad156fbc6036a53a0338819a2b301"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#169ad156fbc6036a53a0338819a2b301"><span class="id" title="notation">++</span></a> ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> %<span class="id" title="var">string</span><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="output_comp" class="idref" href="#output_comp"><span class="id" title="definition">output_comp</span></a>(<a id="A:141" class="idref" href="#A:141"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>):<span class="id" title="keyword">Type</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a><a class="idref" href="Monads.Monads.html#A:141"><span class="id" title="variable">A</span></a>.<br/>

<br/>
</div>

<div class="doc">
In the output monad, a computation consists of the output generated paired 
with the value returned.

<div class="paragraph"> </div>

The call <span class="inlinecode"><a class="idref" href="Monads.StateTransformerMonad.html#ret"><span class="id" title="projection">ret</span></a></span> a returns no output paired with <span class="inlinecode"><span class="id" title="var">x</span></span>. 
In the <span class="inlinecode"><a class="idref" href="Monads.StateTransformerMonad.html#bind"><span class="id" title="projection">bind</span></a></span> we extracts output <span class="inlinecode"><span class="id" title="var">s</span></span> and value <span class="inlinecode"><span class="id" title="var">x</span></span> from computation <span class="inlinecode"><span class="id" title="var">c</span></span>, 
then we extract output <span class="inlinecode"><span class="id" title="var">t</span></span> and value <span class="inlinecode"><span class="id" title="var">y</span></span> from computation <span class="inlinecode"><span class="id" title="var">f</span>(<span class="id" title="var">x</span>)</span>,
and return the output formed by concatenating <span class="inlinecode"><span class="id" title="var">s</span></span> and <span class="inlinecode"><span class="id" title="var">s</span></span> paired with the value <span class="inlinecode"><span class="id" title="var">y</span></span>.
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Instance</span> <a id="OutputMonad" class="idref" href="#OutputMonad"><span class="id" title="instance">OutputMonad</span></a> : <a class="idref" href="Monads.Monads.html#Monad"><span class="id" title="class">Monad</span></a> <a class="idref" href="Monads.Monads.html#output_comp"><span class="id" title="definition">output_comp</span></a> := {<br/>
&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> := <span class="id" title="keyword">fun</span> {<a id="A:142" class="idref" href="#A:142"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>} (<a id="x:143" class="idref" href="#x:143"><span class="id" title="binder">x</span></a>:<a class="idref" href="Monads.Monads.html#A:142"><span class="id" title="variable">A</span></a>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>""%<span class="id" title="var">string</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="Monads.Monads.html#x:143"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ; <br/>
&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> := <span class="id" title="keyword">fun</span> {<a id="A:144" class="idref" href="#A:144"><span class="id" title="binder">A</span></a> <a id="B:145" class="idref" href="#B:145"><span class="id" title="binder">B</span></a>:<span class="id" title="keyword">Type</span>} (<a id="c:146" class="idref" href="#c:146"><span class="id" title="binder">c</span></a> : <a class="idref" href="Monads.Monads.html#output_comp"><span class="id" title="definition">output_comp</span></a> <a class="idref" href="Monads.Monads.html#A:144"><span class="id" title="variable">A</span></a>) (<a id="f:147" class="idref" href="#f:147"><span class="id" title="binder">f</span></a>: <a class="idref" href="Monads.Monads.html#A:144"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#output_comp"><span class="id" title="definition">output_comp</span></a> <a class="idref" href="Monads.Monads.html#B:145"><span class="id" title="variable">B</span></a>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="s:148" class="idref" href="#s:148"><span class="id" title="binder">s</span></a>, <a id="x:149" class="idref" href="#x:149"><span class="id" title="binder">x</span></a>):= <a class="idref" href="Monads.Monads.html#c:146"><span class="id" title="variable">c</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="t:150" class="idref" href="#t:150"><span class="id" title="binder">t</span></a>, <a id="y:151" class="idref" href="#y:151"><span class="id" title="binder">y</span></a>):= <a class="idref" href="Monads.Monads.html#f:147"><span class="id" title="variable">f</span></a> <a class="idref" href="Monads.Monads.html#x:149"><span class="id" title="variable">x</span></a> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">append</span></a> <a class="idref" href="Monads.Monads.html#s:148"><span class="id" title="variable">s</span></a> <a class="idref" href="Monads.Monads.html#t:150"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Monads.Monads.html#y:151"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
}.<br/>

<br/>
</div>

<div class="doc">
As usual, we have to prove that what we have just defined is indeed a monad. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="m_left_id_out_monad" class="idref" href="#m_left_id_out_monad"><span class="id" title="lemma">m_left_id_out_monad</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:152" class="idref" href="#A:152"><span class="id" title="binder">A</span></a> <a id="B:153" class="idref" href="#B:153"><span class="id" title="binder">B</span></a>:<span class="id" title="keyword">Type</span>} (<a id="x:154" class="idref" href="#x:154"><span class="id" title="binder">x</span></a>:<a class="idref" href="Monads.Monads.html#A:152"><span class="id" title="variable">A</span></a>) (<a id="f:155" class="idref" href="#f:155"><span class="id" title="binder">f</span></a>:<a class="idref" href="Monads.Monads.html#A:152"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#output_comp"><span class="id" title="definition">output_comp</span></a> <a class="idref" href="Monads.Monads.html#B:153"><span class="id" title="variable">B</span></a>), <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> (<a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> <a class="idref" href="Monads.Monads.html#x:154"><span class="id" title="variable">x</span></a>) <a class="idref" href="Monads.Monads.html#f:155"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#f:155"><span class="id" title="variable">f</span></a> <a class="idref" href="Monads.Monads.html#x:154"><span class="id" title="variable">x</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="app_empty_str" class="idref" href="#app_empty_str"><span class="id" title="lemma">app_empty_str</span></a>: <span class="id" title="keyword">forall</span> (<a id="s:156" class="idref" href="#s:156"><span class="id" title="binder">s</span></a>:<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>), (<a class="idref" href="Monads.Monads.html#s:156"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#169ad156fbc6036a53a0338819a2b301"><span class="id" title="notation">++</span></a> "")%<span class="id" title="var">string</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#s:156"><span class="id" title="variable">s</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">s</span>. - <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> -&gt; <span class="id" title="var">IHs</span>. <span class="id" title="tactic">trivial</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="m_right_id_out_monad" class="idref" href="#m_right_id_out_monad"><span class="id" title="lemma">m_right_id_out_monad</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:157" class="idref" href="#A:157"><span class="id" title="binder">A</span></a> <a id="B:158" class="idref" href="#B:158"><span class="id" title="binder">B</span></a>:<span class="id" title="keyword">Type</span>} (<a id="c:159" class="idref" href="#c:159"><span class="id" title="binder">c</span></a>:<a class="idref" href="Monads.Monads.html#output_comp"><span class="id" title="definition">output_comp</span></a> <a class="idref" href="Monads.Monads.html#A:157"><span class="id" title="variable">A</span></a>), <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="Monads.Monads.html#c:159"><span class="id" title="variable">c</span></a> <a class="idref" href="Monads.Monads.html#ret"><span class="id" title="method">ret</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#c:159"><span class="id" title="variable">c</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Monads.Monads.html#app_empty_str"><span class="id" title="lemma">app_empty_str</span></a>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="app_assoc_string" class="idref" href="#app_assoc_string"><span class="id" title="lemma">app_assoc_string</span></a>: <span class="id" title="keyword">forall</span> (<a id="s:160" class="idref" href="#s:160"><span class="id" title="binder">s</span></a> <a id="s1:161" class="idref" href="#s1:161"><span class="id" title="binder">s1</span></a> <a id="s2:162" class="idref" href="#s2:162"><span class="id" title="binder">s2</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>), <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">append</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">append</span></a> <a class="idref" href="Monads.Monads.html#s:160"><span class="id" title="variable">s</span></a> <a class="idref" href="Monads.Monads.html#s1:161"><span class="id" title="variable">s1</span></a>) <a class="idref" href="Monads.Monads.html#s2:162"><span class="id" title="variable">s2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">append</span></a> <a class="idref" href="Monads.Monads.html#s:160"><span class="id" title="variable">s</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">append</span></a> <a class="idref" href="Monads.Monads.html#s1:161"><span class="id" title="variable">s1</span></a> <a class="idref" href="Monads.Monads.html#s2:162"><span class="id" title="variable">s2</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">s1</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">s</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHs</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="m_assoc_out_monad" class="idref" href="#m_assoc_out_monad"><span class="id" title="lemma">m_assoc_out_monad</span></a> : <span class="id" title="keyword">forall</span> {<a id="A:163" class="idref" href="#A:163"><span class="id" title="binder">A</span></a> <a id="B:164" class="idref" href="#B:164"><span class="id" title="binder">B</span></a> <a id="C:165" class="idref" href="#C:165"><span class="id" title="binder">C</span></a>} (<a id="c:166" class="idref" href="#c:166"><span class="id" title="binder">c</span></a>:<a class="idref" href="Monads.Monads.html#output_comp"><span class="id" title="definition">output_comp</span></a> <a class="idref" href="Monads.Monads.html#A:163"><span class="id" title="variable">A</span></a>) (<a id="f:167" class="idref" href="#f:167"><span class="id" title="binder">f</span></a>:<a class="idref" href="Monads.Monads.html#A:163"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><a class="idref" href="Monads.Monads.html#output_comp"><span class="id" title="definition">output_comp</span></a> <a class="idref" href="Monads.Monads.html#B:164"><span class="id" title="variable">B</span></a>) (<a id="g:168" class="idref" href="#g:168"><span class="id" title="binder">g</span></a>:<a class="idref" href="Monads.Monads.html#B:164"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Monads.Monads.html#output_comp"><span class="id" title="definition">output_comp</span></a> <a class="idref" href="Monads.Monads.html#C:165"><span class="id" title="variable">C</span></a>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> (<a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="Monads.Monads.html#c:166"><span class="id" title="variable">c</span></a> <a class="idref" href="Monads.Monads.html#f:167"><span class="id" title="variable">f</span></a>) <a class="idref" href="Monads.Monads.html#g:168"><span class="id" title="variable">g</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> <a class="idref" href="Monads.Monads.html#c:166"><span class="id" title="variable">c</span></a> (<span class="id" title="keyword">fun</span> <a id="x:169" class="idref" href="#x:169"><span class="id" title="binder">x</span></a> =&gt; <a class="idref" href="Monads.Monads.html#bind"><span class="id" title="method">bind</span></a> (<a class="idref" href="Monads.Monads.html#f:167"><span class="id" title="variable">f</span></a> <a class="idref" href="Monads.Monads.html#x:169"><span class="id" title="variable">x</span></a>) <a class="idref" href="Monads.Monads.html#g:168"><span class="id" title="variable">g</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>). <span class="id" title="tactic">rewrite</span> <a class="idref" href="Monads.Monads.html#app_assoc_string"><span class="id" title="lemma">app_assoc_string</span></a>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="line" class="idref" href="#line"><span class="id" title="definition">line</span></a>(<a id="t:170" class="idref" href="#t:170"><span class="id" title="binder">t</span></a>:<a class="idref" href="Monads.Monads.html#tm"><span class="id" title="inductive">tm</span></a>) (<a id="n:171" class="idref" href="#n:171"><span class="id" title="binder">n</span></a>:<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>):<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>:=<br/>
(<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">append</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">append</span></a> "eval"%<span class="id" title="var">string</span> (<a class="idref" href="Monads.Monads.html#show"><span class="id" title="method">show</span></a> (<a class="idref" href="Monads.Monads.html#t:170"><span class="id" title="variable">t</span></a>))) (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">append</span></a> "&lt;="%<span class="id" title="var">string</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">append</span></a> (<a class="idref" href="Monads.Monads.html#show"><span class="id" title="method">show</span></a> <a class="idref" href="Monads.Monads.html#n:171"><span class="id" title="variable">n</span></a> ) "
      "%<span class="id" title="var">string</span>))).<br/>

<br/>
</div>

<div class="doc">
Using the <span class="inlinecode"><a class="idref" href="Monads.Monads.html#OutputMonad"><span class="id" title="instance">OutputMonad</span></a></span> we can modify our evaluator so that, for a given computation to perform, 
we collect all the intermediate steps and print them at the end of the computation. The function <span class="inlinecode"><a class="idref" href="Monads.Monads.html#line"><span class="id" title="definition">line</span></a></span> 
 used in the definition below is only used for pretty printing. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="eval_output" class="idref" href="#eval_output"><span class="id" title="definition">eval_output</span></a> (<a id="t:172" class="idref" href="#t:172"><span class="id" title="binder">t</span></a>:<a class="idref" href="Monads.Monads.html#tm"><span class="id" title="inductive">tm</span></a>) : <a class="idref" href="Monads.Monads.html#output_comp"><span class="id" title="definition">output_comp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>  := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#t:172"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> <span class="id" title="var">n</span> =&gt;   <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Monads.Monads.html#line"><span class="id" title="definition">line</span></a> (<a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> <span class="id" title="var">n</span>) <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Div"><span class="id" title="constructor">Div</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>  =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="n1:175" class="idref" href="#n1:175"><span class="id" title="binder">n1</span></a> <a class="idref" href="Monads.Monads.html#f4c072b7f26484005a9e0c3986ed1f19"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Monads.Monads.html#eval_output:173"><span class="id" title="definition">eval_output</span></a> <span class="id" title="var">t1</span> <a class="idref" href="Monads.Monads.html#f4c072b7f26484005a9e0c3986ed1f19"><span class="id" title="notation">;;</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="n2:176" class="idref" href="#n2:176"><span class="id" title="binder">n2</span></a> <a class="idref" href="Monads.Monads.html#f4c072b7f26484005a9e0c3986ed1f19"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Monads.Monads.html#eval_output:173"><span class="id" title="definition">eval_output</span></a> <span class="id" title="var">t2</span> <a class="idref" href="Monads.Monads.html#f4c072b7f26484005a9e0c3986ed1f19"><span class="id" title="notation">;;</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Monads.Monads.html#line"><span class="id" title="definition">line</span></a> (<a class="idref" href="Monads.Monads.html#Div"><span class="id" title="constructor">Div</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>) (<a class="idref" href="Monads.Monads.html#n1:175"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.PeanoNat.html#2e0d8202c5a48097752d760d3a1db6a7"><span class="id" title="notation">/</span></a><a class="idref" href="Monads.Monads.html#n2:176"><span class="id" title="variable">n2</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Monads.Monads.html#n1:175"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.PeanoNat.html#2e0d8202c5a48097752d760d3a1db6a7"><span class="id" title="notation">/</span></a><a class="idref" href="Monads.Monads.html#n2:176"><span class="id" title="variable">n2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="Monads.Monads.html#eval_output"><span class="id" title="definition">eval_output</span></a> <a class="idref" href="Monads.Monads.html#answer"><span class="id" title="definition">answer</span></a> .<br/>

<br/>
<span class="comment">(*&nbsp;=&nbsp;=&nbsp;("eval(Con&nbsp;1972)&lt;=1972<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval(Con&nbsp;2)&lt;=2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval(Div&nbsp;(Con&nbsp;1972)(Con&nbsp;2))&lt;=986<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval(Con&nbsp;23)&lt;=23<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval(Div&nbsp;(Div&nbsp;(Con&nbsp;1972)(Con&nbsp;2))(Con&nbsp;23))&lt;=42<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"*)</span><br/>

<br/>
</div>

<div class="doc">
Note that, to get the output in the reverse order, all 
that is required is to change the definition of <span class="inlinecode"><a class="idref" href="Monads.StateTransformerMonad.html#bind"><span class="id" title="projection">bind</span></a></span>, replacing <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">append</span></a></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> by <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">append</span></a></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span>. 
This is commensurate with the change 
required in the pure program, and rather simpler than the change required in an impure program.
<div class="paragraph"> </div>

 As for the two cases above, we present a solution of the problem of defining the output evaluator that does
not make use of the Output Monad. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="eval_output_no_monad" class="idref" href="#eval_output_no_monad"><span class="id" title="definition">eval_output_no_monad</span></a> (<a id="t:177" class="idref" href="#t:177"><span class="id" title="binder">t</span></a>:<a class="idref" href="Monads.Monads.html#tm"><span class="id" title="inductive">tm</span></a>) : <a class="idref" href="Monads.Monads.html#output_comp"><span class="id" title="definition">output_comp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>  := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Monads.Monads.html#t:177"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> <span class="id" title="var">n</span> =&gt;   <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Monads.Monads.html#line"><span class="id" title="definition">line</span></a> (<a class="idref" href="Monads.Monads.html#Con"><span class="id" title="constructor">Con</span></a> <span class="id" title="var">n</span>) <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Monads.Monads.html#Div"><span class="id" title="constructor">Div</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>  =&gt; <span class="id" title="keyword">let</span> (<a id="s1:180" class="idref" href="#s1:180"><span class="id" title="binder">s1</span></a>, <a id="n1:181" class="idref" href="#n1:181"><span class="id" title="binder">n1</span></a>):= <a class="idref" href="Monads.Monads.html#eval_output_no_monad:178"><span class="id" title="definition">eval_output_no_monad</span></a> <span class="id" title="var">t1</span> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="s2:182" class="idref" href="#s2:182"><span class="id" title="binder">s2</span></a>, <a id="n2:183" class="idref" href="#n2:183"><span class="id" title="binder">n2</span></a>):= <a class="idref" href="Monads.Monads.html#eval_output_no_monad:178"><span class="id" title="definition">eval_output_no_monad</span></a> <span class="id" title="var">t2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">append</span></a> <a class="idref" href="Monads.Monads.html#s1:180"><span class="id" title="variable">s1</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">append</span></a> <a class="idref" href="Monads.Monads.html#s2:182"><span class="id" title="variable">s2</span></a> (<a class="idref" href="Monads.Monads.html#line"><span class="id" title="definition">line</span></a> (<a class="idref" href="Monads.Monads.html#Div"><span class="id" title="constructor">Div</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>) (<a class="idref" href="Monads.Monads.html#n1:181"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.PeanoNat.html#2e0d8202c5a48097752d760d3a1db6a7"><span class="id" title="notation">/</span></a><a class="idref" href="Monads.Monads.html#n2:183"><span class="id" title="variable">n2</span></a>)))<a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Monads.Monads.html#n1:181"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Arith.PeanoNat.html#2e0d8202c5a48097752d760d3a1db6a7"><span class="id" title="notation">/</span></a><a class="idref" href="Monads.Monads.html#n2:183"><span class="id" title="variable">n2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="eval_output_equiv" class="idref" href="#eval_output_equiv"><span class="id" title="lemma">eval_output_equiv</span></a>: <span class="id" title="keyword">forall</span> <a id="t:184" class="idref" href="#t:184"><span class="id" title="binder">t</span></a>, <a class="idref" href="Monads.Monads.html#eval_output"><span class="id" title="definition">eval_output</span></a> <a class="idref" href="Monads.Monads.html#t:184"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Monads.Monads.html#eval_output_no_monad"><span class="id" title="definition">eval_output_no_monad</span></a> <a class="idref" href="Monads.Monads.html#t:184"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>.<br/>
- <span class="id" title="tactic">auto</span>.<br/>
- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt2</span>.<br/>
<span class="id" title="tactic">destruct</span> (<a class="idref" href="Monads.Monads.html#eval_output_no_monad"><span class="id" title="definition">eval_output_no_monad</span></a> <span class="id" title="var">t1</span>). <span class="id" title="tactic">destruct</span> (<a class="idref" href="Monads.Monads.html#eval_output_no_monad"><span class="id" title="definition">eval_output_no_monad</span></a> <span class="id" title="var">t2</span>). <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="Monads.Monads.html#eval_output_no_monad"><span class="id" title="definition">eval_output_no_monad</span></a> <a class="idref" href="Monads.Monads.html#answer"><span class="id" title="definition">answer</span></a> .<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
